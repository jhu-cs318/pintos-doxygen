<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CS318 - Pintos: thread Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CS318 - Pintos
   </div>
   <div id="projectbrief">Pintos source browser for JHU CS318 course</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">thread Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A kernel thread or user process.  
 <a href="structthread.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="thread_8h_source.html">thread.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for thread:</div>
<div class="dyncontent">
<div class="center"><img src="structthread__coll__graph.png" border="0" usemap="#thread_coll__map" alt="Collaboration graph"/></div>
<map name="thread_coll__map" id="thread_coll__map">
<area shape="rect" title="A kernel thread or user process." alt="" coords="13,107,72,132"/>
<area shape="rect" href="structlist__elem.html" title="Doubly linked list." alt="" coords="5,6,79,31"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a7360cfa969a95354a5756946205b1138"><td class="memItemLeft" align="right" valign="top"><a class="el" href="thread_8h.html#a7a78d8e6bd74b48dbd812f553678d9a5">tid_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structthread.html#a7360cfa969a95354a5756946205b1138">tid</a></td></tr>
<tr class="memdesc:a7360cfa969a95354a5756946205b1138"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread identifier.  <a href="structthread.html#a7360cfa969a95354a5756946205b1138">More...</a><br /></td></tr>
<tr class="separator:a7360cfa969a95354a5756946205b1138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0b66a487cfb69469a807077cd801290"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="thread_8h.html#a3ba0ae993b26446020f1d02c37341f8e">thread_status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structthread.html#ac0b66a487cfb69469a807077cd801290">status</a></td></tr>
<tr class="memdesc:ac0b66a487cfb69469a807077cd801290"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread state.  <a href="structthread.html#ac0b66a487cfb69469a807077cd801290">More...</a><br /></td></tr>
<tr class="separator:ac0b66a487cfb69469a807077cd801290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59ebdca51eb8eabddbe6d26b4c13c3ab"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structthread.html#a59ebdca51eb8eabddbe6d26b4c13c3ab">name</a> [16]</td></tr>
<tr class="memdesc:a59ebdca51eb8eabddbe6d26b4c13c3ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name (for debugging purposes).  <a href="structthread.html#a59ebdca51eb8eabddbe6d26b4c13c3ab">More...</a><br /></td></tr>
<tr class="separator:a59ebdca51eb8eabddbe6d26b4c13c3ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13be198956c306ad7f4ab1de2a91df73"><td class="memItemLeft" align="right" valign="top"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structthread.html#a13be198956c306ad7f4ab1de2a91df73">stack</a></td></tr>
<tr class="memdesc:a13be198956c306ad7f4ab1de2a91df73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saved stack pointer.  <a href="structthread.html#a13be198956c306ad7f4ab1de2a91df73">More...</a><br /></td></tr>
<tr class="separator:a13be198956c306ad7f4ab1de2a91df73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04d1040ba1acd5961797345743567293"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structthread.html#a04d1040ba1acd5961797345743567293">priority</a></td></tr>
<tr class="memdesc:a04d1040ba1acd5961797345743567293"><td class="mdescLeft">&#160;</td><td class="mdescRight">Priority.  <a href="structthread.html#a04d1040ba1acd5961797345743567293">More...</a><br /></td></tr>
<tr class="separator:a04d1040ba1acd5961797345743567293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21b7f77466e0383cc9dd51988ea131d6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlist__elem.html">list_elem</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structthread.html#a21b7f77466e0383cc9dd51988ea131d6">allelem</a></td></tr>
<tr class="memdesc:a21b7f77466e0383cc9dd51988ea131d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">List element for all threads list.  <a href="structthread.html#a21b7f77466e0383cc9dd51988ea131d6">More...</a><br /></td></tr>
<tr class="separator:a21b7f77466e0383cc9dd51988ea131d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4542f0a9644fb012de20399c8e15c741"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlist__elem.html">list_elem</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structthread.html#a4542f0a9644fb012de20399c8e15c741">elem</a></td></tr>
<tr class="memdesc:a4542f0a9644fb012de20399c8e15c741"><td class="mdescLeft">&#160;</td><td class="mdescRight">List element.  <a href="structthread.html#a4542f0a9644fb012de20399c8e15c741">More...</a><br /></td></tr>
<tr class="separator:a4542f0a9644fb012de20399c8e15c741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a49980d160800cda815248d91e47052"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structthread.html#a3a49980d160800cda815248d91e47052">magic</a></td></tr>
<tr class="memdesc:a3a49980d160800cda815248d91e47052"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detects stack overflow.  <a href="structthread.html#a3a49980d160800cda815248d91e47052">More...</a><br /></td></tr>
<tr class="separator:a3a49980d160800cda815248d91e47052"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A kernel thread or user process. </p>
<p>Each thread structure is stored in its own 4 kB page. The thread structure itself sits at the very bottom of the page (at offset 0). The rest of the page is reserved for the thread's kernel stack, which grows downward from the top of the page (at offset 4 kB). Here's an illustration: </p><pre class="fragment"> 4 kB +---------------------------------+
      |          kernel stack           |
      |                |                |
      |                |                |
      |                V                |
      |         grows downward          |
      |                                 |
      |                                 |
      |                                 |
      |                                 |
      |                                 |
      |                                 |
      |                                 |
      |                                 |
      +---------------------------------+
      |              magic              |
      |                :                |
      |                :                |
      |               name              |
      |              status             |
 0 kB +---------------------------------+
</pre><p>The upshot of this is twofold:</p>
<ol type="1">
<li>First, &lsquo;struct thread&rsquo; must not be allowed to grow too big. If it does, then there will not be enough room for the kernel stack. Our base &lsquo;struct thread&rsquo; is only a few bytes in size. It probably should stay well under 1 kB.</li>
<li>Second, kernel stacks must not be allowed to grow too large. If a stack overflows, it will corrupt the thread state. Thus, kernel functions should not allocate large structures or arrays as non-static local variables. Use dynamic allocation with <a class="el" href="malloc_8c.html#a7ac38fce3243a7dcf448301ee9ffd392" title="Obtains and returns a new block of at least SIZE bytes.">malloc()</a> or <a class="el" href="palloc_8c.html#aa8cccdccaa05d4023e3e65c15ed486af" title="Obtains a single free page and returns its kernel virtual address.">palloc_get_page()</a> instead.</li>
</ol>
<p>The first symptom of either of these problems will probably be an assertion failure in <a class="el" href="thread_8c.html#a13774a29a2abd2f197ceb07815f2a6ff" title="Returns the running thread.">thread_current()</a>, which checks that the &lsquo;magic&rsquo; member of the running thread's &lsquo;struct thread&rsquo; is set to THREAD_MAGIC. Stack overflow will normally change this value, triggering the assertion. The &lsquo;elem&rsquo; member has a dual purpose. It can be an element in the run queue (<a class="el" href="thread_8c.html">thread.c</a>), or it can be an element in a semaphore wait list (<a class="el" href="synch_8c.html">synch.c</a>). It can be used these two ways only because they are mutually exclusive: only a thread in the ready state is on the run queue, whereas only a thread in the blocked state is on a semaphore wait list. </p>

<p class="definition">Definition at line <a class="el" href="thread_8h_source.html#l00083">83</a> of file <a class="el" href="thread_8h_source.html">thread.h</a>.</p>
</div><h2 class="groupheader">Field Documentation</h2>
<a id="a21b7f77466e0383cc9dd51988ea131d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21b7f77466e0383cc9dd51988ea131d6">&#9670;&nbsp;</a></span>allelem</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlist__elem.html">list_elem</a> thread::allelem</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List element for all threads list. </p>

<p class="definition">Definition at line <a class="el" href="thread_8h_source.html#l00091">91</a> of file <a class="el" href="thread_8h_source.html">thread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="thread_8c_source.html#l00452">init_thread()</a>, <a class="el" href="thread_8c_source.html#l00281">thread_exit()</a>, and <a class="el" href="thread_8c_source.html#l00320">thread_foreach()</a>.</p>

</div>
</div>
<a id="a4542f0a9644fb012de20399c8e15c741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4542f0a9644fb012de20399c8e15c741">&#9670;&nbsp;</a></span>elem</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlist__elem.html">list_elem</a> thread::elem</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List element. </p>

<p class="definition">Definition at line <a class="el" href="thread_8h_source.html#l00094">94</a> of file <a class="el" href="thread_8h_source.html">thread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="thread_8c_source.html#l00491">next_thread_to_run()</a>, <a class="el" href="thread_8c_source.html#l00232">thread_unblock()</a>, and <a class="el" href="thread_8c_source.html#l00302">thread_yield()</a>.</p>

</div>
</div>
<a id="a3a49980d160800cda815248d91e47052"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a49980d160800cda815248d91e47052">&#9670;&nbsp;</a></span>magic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned thread::magic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detects stack overflow. </p>

<p class="definition">Definition at line <a class="el" href="thread_8h_source.html#l00102">102</a> of file <a class="el" href="thread_8h_source.html">thread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="thread_8c_source.html#l00452">init_thread()</a>.</p>

</div>
</div>
<a id="a59ebdca51eb8eabddbe6d26b4c13c3ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59ebdca51eb8eabddbe6d26b4c13c3ab">&#9670;&nbsp;</a></span>name</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char thread::name[16]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Name (for debugging purposes). </p>

<p class="definition">Definition at line <a class="el" href="thread_8h_source.html#l00088">88</a> of file <a class="el" href="thread_8h_source.html">thread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="thread_8c_source.html#l00452">init_thread()</a>, <a class="el" href="kernel_2debug_8c_source.html#l00056">print_stacktrace()</a>, and <a class="el" href="thread_8c_source.html#l00247">thread_name()</a>.</p>

</div>
</div>
<a id="a04d1040ba1acd5961797345743567293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04d1040ba1acd5961797345743567293">&#9670;&nbsp;</a></span>priority</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int thread::priority</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Priority. </p>

<p class="definition">Definition at line <a class="el" href="thread_8h_source.html#l00090">90</a> of file <a class="el" href="thread_8h_source.html">thread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="thread_8c_source.html#l00452">init_thread()</a>, <a class="el" href="thread_8c_source.html#l00343">thread_get_priority()</a>, and <a class="el" href="thread_8c_source.html#l00336">thread_set_priority()</a>.</p>

</div>
</div>
<a id="a13be198956c306ad7f4ab1de2a91df73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13be198956c306ad7f4ab1de2a91df73">&#9670;&nbsp;</a></span>stack</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="stdint_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>* thread::stack</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saved stack pointer. </p>

<p class="definition">Definition at line <a class="el" href="thread_8h_source.html#l00089">89</a> of file <a class="el" href="thread_8h_source.html">thread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="thread_8c_source.html#l00475">alloc_frame()</a>, <a class="el" href="thread_8c_source.html#l00452">init_thread()</a>, and <a class="el" href="kernel_2debug_8c_source.html#l00056">print_stacktrace()</a>.</p>

</div>
</div>
<a id="ac0b66a487cfb69469a807077cd801290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0b66a487cfb69469a807077cd801290">&#9670;&nbsp;</a></span>status</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="thread_8h.html#a3ba0ae993b26446020f1d02c37341f8e">thread_status</a> thread::status</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Thread state. </p>

<p class="definition">Definition at line <a class="el" href="thread_8h_source.html#l00087">87</a> of file <a class="el" href="thread_8h_source.html">thread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="thread_8c_source.html#l00452">init_thread()</a>, <a class="el" href="kernel_2debug_8c_source.html#l00056">print_stacktrace()</a>, <a class="el" href="thread_8c_source.html#l00553">schedule()</a>, <a class="el" href="thread_8c_source.html#l00214">thread_block()</a>, <a class="el" href="thread_8c_source.html#l00256">thread_current()</a>, <a class="el" href="thread_8c_source.html#l00281">thread_exit()</a>, <a class="el" href="thread_8c_source.html#l00516">thread_schedule_tail()</a>, <a class="el" href="thread_8c_source.html#l00232">thread_unblock()</a>, and <a class="el" href="thread_8c_source.html#l00302">thread_yield()</a>.</p>

</div>
</div>
<a id="a7360cfa969a95354a5756946205b1138"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7360cfa969a95354a5756946205b1138">&#9670;&nbsp;</a></span>tid</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="thread_8h.html#a7a78d8e6bd74b48dbd812f553678d9a5">tid_t</a> thread::tid</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Thread identifier. </p>

<p class="definition">Definition at line <a class="el" href="thread_8h_source.html#l00086">86</a> of file <a class="el" href="thread_8h_source.html">thread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="thread_8c_source.html#l00570">allocate_tid()</a>, <a class="el" href="process_8c_source.html#l00029">process_execute()</a>, <a class="el" href="thread_8c_source.html#l00166">thread_create()</a>, and <a class="el" href="thread_8c_source.html#l00273">thread_tid()</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>src/threads/<a class="el" href="thread_8h_source.html">thread.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Aug 22 2019 10:19:18 for CS318 - Pintos by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
